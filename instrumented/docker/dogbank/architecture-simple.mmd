flowchart TB
    subgraph CLIENTS["ğŸŒ CLIENTS"]
        WEB["ğŸ–¥ï¸ Web App"]
        MOBILE["ğŸ“± Mobile"]
    end

    subgraph GATEWAY["ğŸ”’ NGINX GATEWAY"]
        HTTP["HTTP :80"]
        HTTPS["HTTPS :443<br/>TLS 1.3 | HTTP/2"]
        SECURITY["ğŸ›¡ï¸ Security<br/>Rate Limit | CORS | Headers"]
    end

    subgraph SERVICES["âš™ï¸ MICROSERVICES"]
        AUTH["ğŸ”‘ Auth<br/>:8088"]
        ACCOUNT["ğŸ’³ Account<br/>:8089"]
        TRANSACTION["ğŸ’¸ Transaction<br/>:8084"]
        AUTORIZADOR["âœ… Autorizador<br/>:8090"]
        LEDGER["ğŸ“’ Ledger<br/>:8091"]
        BANCOCENTRAL["ğŸ›ï¸ Banco Central<br/>:8085"]
        INTEGRATION["ğŸ”— Integration<br/>:8082"]
        NOTIFICATION["ğŸ“¢ Notification<br/>:8083"]
    end

    subgraph DATA["ğŸ’¾ DATA"]
        POSTGRES[("ğŸ˜ PostgreSQL<br/>:5432")]
        REDIS[("âš¡ Redis<br/>:6379")]
    end

    subgraph OBS["ğŸ“Š OBSERVABILITY"]
        DATADOG["ğŸ• Datadog"]
    end

    WEB --> HTTPS
    MOBILE --> HTTPS
    HTTP -.->|redirect| HTTPS
    HTTPS --> SECURITY
    
    SECURITY --> AUTH
    SECURITY --> ACCOUNT
    SECURITY --> TRANSACTION
    SECURITY --> AUTORIZADOR
    SECURITY --> LEDGER
    SECURITY --> BANCOCENTRAL
    SECURITY --> INTEGRATION
    SECURITY --> NOTIFICATION

    AUTH --> POSTGRES
    ACCOUNT --> POSTGRES
    TRANSACTION --> POSTGRES
    AUTORIZADOR --> POSTGRES
    LEDGER --> POSTGRES
    BANCOCENTRAL --> POSTGRES
    NOTIFICATION --> POSTGRES
    
    TRANSACTION --> BANCOCENTRAL
    TRANSACTION --> AUTORIZADOR
    TRANSACTION --> LEDGER
    TRANSACTION --> ACCOUNT
    
    AUTH -.-> REDIS
    AUTORIZADOR -.-> REDIS
    
    INTEGRATION --> DATADOG

    classDef new fill:#00b894,stroke:#fff,stroke-width:2px,color:#fff
    class AUTORIZADOR,LEDGER new
